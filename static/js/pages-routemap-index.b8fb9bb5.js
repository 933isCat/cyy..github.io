(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-routemap-index"],{"0421":function(t,e,i){var o=i("6f6c");o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var n=i("4f06").default;n("25982d2c",o,!0,{sourceMap:!1,shadowMode:!1})},"3cc6":function(t,e,i){"use strict";i.r(e);var o=i("ef8d"),n=i("3ea6");for(var a in n)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(a);i("c555");var s=i("f0c5"),r=Object(s["a"])(n["default"],o["b"],o["c"],!1,null,"d6e6c622",null,!1,o["a"],void 0);e["default"]=r.exports},"3ea6":function(t,e,i){"use strict";i.r(e);var o=i("6b4f"),n=i.n(o);for(var a in o)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(a);e["default"]=n.a},"6b4f":function(t,e,i){"use strict";i("7a82");var o=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=o(i("c7eb")),a=o(i("1da1"));i("d81d"),i("14d9"),i("d3b7"),i("159b"),i("a9e3"),i("a434");var s=o(i("57ec")),r=o(i("7c3c")),u={components:{NavBar:s.default},data:function(){return{imgUrl:this.$store.getters.imgUrl,longitude:"",latitude:"",polyline:[],isStart:!1,markers:[],oldLocation:"",oldTime:""}},created:function(){var t=[this.imgUrl+"start.png",this.imgUrl+"max.png"];this.markers=["119.913848,32.455493","119.915043,32.455749"].map((function(e,i){return{id:i+1,latitude:e.split(",")[1],longitude:e.split(",")[0],iconPath:t[i]+"?v=1",width:30,height:30}})),this.latitude=this.markers[0].latitude,this.longitude=this.markers[0].longitude},methods:{canIUse:function(){this.getData()},getData:function(){var t=this;return(0,a.default)((0,n.default)().mark((function e(){return(0,n.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:uni.startLocationUpdate?(t.isStart=!t.isStart,t.isStart?(t.points=[],uni.startLocationUpdate({type:"gcj02",success:function(e){console.log("🤡 ❗ getData ❗ res:",e),uni.onLocationChange?(uni.showToast({icon:"none",duration:2e3,position:"bottom",title:"开始运动"}),uni.onLocationChange(t.listener)):t.errHandle(err)},fail:function(e){t.errHandle(e)}})):(uni.showToast({icon:"none",duration:2e3,position:"bottom",title:"结束运动"}),console.log("行驶里程",t.moveSum(t.points)),t.stopLocationUpdateFn())):t.errHandle(err);case 1:case"end":return e.stop()}}),e)})))()},listener:function(t){console.log("🤡 ❗ listener ❗ res:",t),this.points.push({latitude:t.latitude,longitude:t.longitude}),this.latitude=t.latitude,this.longitude=t.longitude,this.$set(this.markers[2],"latitude",this.latitude),this.$set(this.markers[2],"longitude",this.longitude),this.$forceUpdate(),this.moveUpload(t)},moveUpload:function(t){var e=(new Date).getTime(),i=t.latitude+""+t.longitude;this.oldLocation!=i&&e-this.oldTime>1e4&&(this.oldLocation=i,this.oldTime=e,this.uploadLocation(t))},uploadLocation:function(t){console.log("🤡 ❗ uploadLocation ❗ data:",t),uni.showToast({icon:"none",position:"top",title:"接口调用了"})},errHandle:function(t){t?console.log("### err ###>>>>>>>>",t):uni.showToast({icon:"none",position:"bottom",title:"当前微信版本过低，无法使用该功能，请升级到最新微信版本后重试。"})},toBack:function(){var t=this;this.isStart?uni.showModal({title:"提示",content:"即将关闭实时定位，是否确认返回上一页？",success:function(e){e.confirm&&(t.isStart=!1,t.points=[],t.stopLocationUpdateFn(),uni.navigateBack({delta:1}))}}):(this.isStart=!1,uni.navigateBack({delta:1}))},startFn:function(){this.canIUse()},getLocationPromise:function(){var t=this;return new Promise((function(e,i){uni.getLocation({type:"gcj02",success:function(i){e(t.getFn(i))}})}))},moveSum:function(t){var e=0;return t.forEach((function(t,i,o){e+=Number(r.default.calcCoordsDistance(t,o[i+1]).mVal)})),e},getFn:function(t){console.log("🤡 ❗ getFn ❗ res:",t);var e={};e=this.isStart?{longitude:this.markers[1].longitude+"",latitude:this.markers[1].latitude+""}:{longitude:this.markers[0].longitude+"",latitude:this.markers[0].latitude+""};var i={longitude:t.longitude+"",latitude:t.latitude+""};return r.default.calcCoordsDistance(e,i)},stopLocationUpdateFn:function(){this.markers.splice(2,1),this.oldLocation="",this.oldTime="",uni.stopLocationUpdate(),uni.offLocationChange(this.listener)}}};e.default=u},"6f6c":function(t,e,i){var o=i("24fb");e=o(!1),e.push([t.i,".routemap .surplusHeight[data-v-d6e6c622]{position:relative}.routemap .btnBox[data-v-d6e6c622]{bottom:40px;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);position:absolute;width:%?690?%;height:%?213?%}.routemap .btnBox .bottomBg[data-v-d6e6c622]{position:absolute;z-index:1;left:0;bottom:0;width:%?690?%;height:%?152?%}.routemap .btnBox .btn[data-v-d6e6c622]{position:absolute;z-index:2;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);top:0;width:%?180?%;height:%?190?%;font-size:%?52?%;color:#fff;font-weight:700}.routemap .btnBox .btn .btnBg[data-v-d6e6c622]{position:absolute;z-index:1;top:0;left:0;width:100%;height:100%}.routemap .btnBox .btn .btnTxt[data-v-d6e6c622]{position:absolute;z-index:2;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);width:-webkit-max-content;width:max-content}.routemap .btnBox .btnMore[data-v-d6e6c622]{position:absolute;z-index:2;right:%?77?%;bottom:%?32?%;width:%?102?%;height:%?99?%}.routemap .btnBox .name[data-v-d6e6c622]{position:absolute;z-index:2;left:%?30?%;bottom:%?73?%;width:-webkit-max-content;width:max-content;font-size:%?32?%;color:#fff}.routemap .btnBox .percentageBox[data-v-d6e6c622]{position:absolute;z-index:2;left:%?30?%;bottom:%?40?%;width:%?120?%;height:%?12?%;background:#fff;border-radius:%?6?%}.routemap .btnBox .percentageBox .percentage[data-v-d6e6c622]{position:absolute;z-index:2;left:1px;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);width:100%;height:%?10?%;background:linear-gradient(180deg,#fd9d00,#fa6400);border-radius:%?5?%}",""]),t.exports=e},c555:function(t,e,i){"use strict";var o=i("0421"),n=i.n(o);n.a},ef8d:function(t,e,i){"use strict";i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return n})),i.d(e,"a",(function(){}));var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"pageBox routemap"},[i("NavBar",{attrs:{back:!0,autoBack:!1,title:" ",immersive:!0,backgroundColor:"transparent"},on:{toBack:function(e){arguments[0]=e=t.$handleEvent(e),t.toBack.apply(void 0,arguments)}}}),i("v-uni-view",{staticClass:"surplusHeight"},[i("v-uni-map",{staticClass:"map",staticStyle:{width:"100%",height:"100%"},attrs:{id:"map",scale:"18",longitude:t.longitude,latitude:t.latitude,markers:t.markers,polyline:t.polyline}},[i("v-uni-cover-view",{staticClass:"btnBox"},[i("v-uni-cover-image",{staticClass:"bottomBg",attrs:{src:t.imgUrl+"t6.png"}}),i("v-uni-cover-view",{staticClass:"btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.startFn.apply(void 0,arguments)}}},[i("v-uni-cover-image",{staticClass:"btnBg",attrs:{src:t.imgUrl+"t7.png"}}),i("v-uni-cover-view",{staticClass:"btnTxt"},[t._v(t._s(t.isStart?"结束":"开始"))])],1),i("v-uni-cover-image",{staticClass:"btnMore",attrs:{src:t.imgUrl+"t8.png"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toBack.apply(void 0,arguments)}}}),i("v-uni-cover-view",{staticClass:"name"},[t._v("溱湖路线")])],1)],1)],1)],1)},n=[]}}]);